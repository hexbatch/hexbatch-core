openapi: 3.1.0
paths:
  /api/hbc-things/v1/hooks/list:
    get:
      tags:
        - hook
      summary: 'List all the hooks registered to this owner'
      description: ''
      operationId: hbc-things.hooks.list
      parameters:
        -
          name: 'Search params'
          in: query
          description: 'Optionally search'
          allowEmptyValue: true
          schema:
            $ref: '#/components/schemas/HookSearchParams'
      responses:
        '200':
          description: 'The hook list'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HookCollectionResponse'
        '422':
          description: 'Validation fails'
          content:
            application/json:
              schema:
                $ref: App\OpenApi\ErrorResponse
        '400':
          description: 'When not logged in'
          content:
            application/json:
              schema:
                $ref: App\OpenApi\ErrorResponse
              example:
                status: 400
                message: Unauthenticated.
      security:
        -
          bearerAuth: []
  /api/hbc-things/v1/hooks/admin/list:
    get:
      tags:
        - hook
        - admin
      summary: 'List all the hooks'
      description: ''
      operationId: hbc-things.hooks.admin.list
      parameters:
        -
          name: 'Search params'
          in: query
          description: 'Optionally search'
          allowEmptyValue: true
          schema:
            $ref: '#/components/schemas/HookSearchParams'
      responses:
        '200':
          description: 'The hook list'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HookCollectionResponse'
        '422':
          description: 'Validation fails'
          content:
            application/json:
              schema:
                $ref: App\OpenApi\ErrorResponse
        '400':
          description: 'When not logged in'
          content:
            application/json:
              schema:
                $ref: App\OpenApi\ErrorResponse
              example:
                status: 400
                message: Unauthenticated.
        '403':
          description: 'When not admin'
          content:
            application/json:
              schema:
                $ref: App\OpenApi\ErrorResponse
              example:
                status: 403
                message: 'Not an admin.'
      security:
        -
          bearerAuth: []
  '/api/hbc-things/v1/hooks/admin/{thing_hook}/destroy':
    delete:
      tags:
        - hook
        - admin
      summary: 'Removes a hook'
      description: ''
      operationId: hbc-things.hooks.admin.destroy
      parameters:
        -
          name: thing_hook
          in: path
          description: 'uuid of the hook'
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '202':
          description: 'The shown hook'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HookResponse'
        '400':
          description: 'When not logged in'
          content:
            application/json:
              schema:
                $ref: App\OpenApi\ErrorResponse
              example:
                status: 400
                message: Unauthenticated.
        '403':
          description: 'When not admin'
          content:
            application/json:
              schema:
                $ref: App\OpenApi\ErrorResponse
              example:
                status: 403
                message: 'Not an admin.'
      security:
        -
          bearerAuth: []
  '/api/hbc-things/v1/hooks/admin/{thing_hook}/show':
    get:
      tags:
        - hook
        - admin
      summary: 'Shows information about a hook'
      description: ''
      operationId: hbc-things.hooks.admin.show
      parameters:
        -
          name: thing_hook
          in: path
          description: 'uuid of the hook'
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: 'The shown hook'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HookResponse'
        '400':
          description: 'When not logged in'
          content:
            application/json:
              schema:
                $ref: App\OpenApi\ErrorResponse
              example:
                status: 400
                message: Unauthenticated.
        '403':
          description: 'When not admin'
          content:
            application/json:
              schema:
                $ref: App\OpenApi\ErrorResponse
              example:
                status: 403
                message: 'Not an admin.'
      security:
        -
          bearerAuth: []
  /api/hbc-things/v1/hooks/create:
    post:
      tags:
        - hook
      summary: 'Create a new hook'
      description: 'Make a hook with or without defined callback responses'
      operationId: hbc-things.hooks.create
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/HookParams'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/HookParams'
      responses:
        '201':
          description: 'The created hook'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HookResponse'
        '422':
          description: 'Validation fails'
          content:
            application/json:
              schema:
                $ref: App\OpenApi\ErrorResponse
        '400':
          description: 'When not logged in'
          content:
            application/json:
              schema:
                $ref: App\OpenApi\ErrorResponse
              example:
                status: 400
                message: Unauthenticated.
      security:
        -
          bearerAuth: []
  '/api/hbc-things/v1/hooks/{thing_hook}/show':
    get:
      tags:
        - hook
      summary: 'Shows information about a hook'
      description: ''
      operationId: hbc-things.hooks.show
      parameters:
        -
          name: thing_hook
          in: path
          description: 'uuid of the hook'
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: 'The shown hook'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HookResponse'
        '400':
          description: 'When not logged in'
          content:
            application/json:
              schema:
                $ref: App\OpenApi\ErrorResponse
              example:
                status: 400
                message: Unauthenticated.
      security:
        -
          bearerAuth: []
  '/api/hbc-things/v1/hooks/{thing_hook}/edit':
    patch:
      tags:
        - hook
      summary: 'Edits a hook'
      description: 'Affects future hooks'
      operationId: hbc-things.hooks.edit
      parameters:
        -
          name: thing_hook
          in: path
          description: 'uuid of the hook'
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/HookParams'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/HookParams'
      responses:
        '200':
          description: 'The edited hook'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HookResponse'
        '422':
          description: 'Validation fails'
          content:
            application/json:
              schema:
                $ref: App\OpenApi\ErrorResponse
        '400':
          description: 'When not logged in'
          content:
            application/json:
              schema:
                $ref: App\OpenApi\ErrorResponse
              example:
                status: 400
                message: Unauthenticated.
      security:
        -
          bearerAuth: []
  '/api/hbc-things/v1/hooks/{thing_hook}/destroy':
    delete:
      tags:
        - hook
      summary: 'Deletes a hook'
      description: ''
      operationId: hbc-things.hooks.destroy
      parameters:
        -
          name: thing_hook
          in: path
          description: 'uuid of the hook'
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '202':
          description: 'The shown hook'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HookResponse'
        '400':
          description: 'When not logged in'
          content:
            application/json:
              schema:
                $ref: App\OpenApi\ErrorResponse
              example:
                status: 400
                message: Unauthenticated.
        '403':
          description: 'When not admin'
          content:
            application/json:
              schema:
                $ref: App\OpenApi\ErrorResponse
              example:
                status: 403
                message: 'Not an admin.'
      security:
        -
          bearerAuth: []
  /api/hbc-things/v1/things/list:
    get:
      tags:
        - thing
      summary: 'Lists top things that are owned by user'
      description: 'Shows tree status, times, progress'
      operationId: hbc-things.things.list
      parameters:
        -
          name: 'Search things'
          in: query
          description: 'Optionally search'
          allowEmptyValue: true
          schema:
            $ref: '#/components/schemas/ThingSearchParams'
      responses:
        '200':
          description: 'The things'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ThingCollectionResponse'
        '422':
          description: 'Validation fails'
          content:
            application/json:
              schema:
                $ref: App\OpenApi\ErrorResponse
        '400':
          description: 'When not logged in'
          content:
            application/json:
              schema:
                $ref: App\OpenApi\ErrorResponse
              example:
                status: 400
                message: Unauthenticated.
      security:
        -
          bearerAuth: []
  /api/hbc-things/v1/things/admin/list:
    get:
      tags:
        - thing
        - admin
      summary: 'Lists top things that are owned by user'
      description: 'Shows tree status, times, progress'
      operationId: hbc-things.things.admin.list
      parameters:
        -
          name: 'Search things'
          in: query
          description: 'Optionally search'
          allowEmptyValue: true
          schema:
            $ref: '#/components/schemas/ThingSearchParams'
      responses:
        '200':
          description: 'The things'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ThingCollectionResponse'
        '422':
          description: 'Validation fails'
          content:
            application/json:
              schema:
                $ref: App\OpenApi\ErrorResponse
        '400':
          description: 'When not logged in'
          content:
            application/json:
              schema:
                $ref: App\OpenApi\ErrorResponse
              example:
                status: 400
                message: Unauthenticated.
        '403':
          description: 'When not admin'
          content:
            application/json:
              schema:
                $ref: App\OpenApi\ErrorResponse
              example:
                status: 403
                message: 'Not an admin.'
      security:
        -
          bearerAuth: []
  '/api/hbc-things/v1/things/{thing}/show':
    get:
      tags:
        - thing
      summary: 'Shows a thing and its descendants'
      description: 'Lesser detail in decendants'
      operationId: hbc-things.things.show
      parameters:
        -
          name: thing
          in: path
          description: 'uuid of the thing'
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: 'The thing'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ThingResponse'
        '400':
          description: 'When not logged in'
          content:
            application/json:
              schema:
                $ref: App\OpenApi\ErrorResponse
              example:
                status: 400
                message: Unauthenticated.
      security:
        -
          bearerAuth: []
  '/api/hbc-things/v1/things/{thing}/show_errors':
    get:
      tags:
        - thing
      summary: 'Shows a thing and its errors'
      description: 'Shows the thing and any errors in the tree under it. The errors will be sorted by oldest first'
      operationId: hbc-things.things.show_errors
      parameters:
        -
          name: thing
          in: path
          description: 'uuid of the thing'
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: 'The thing'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ThingErrorCollectionResponse'
        '400':
          description: 'When not logged in'
          content:
            application/json:
              schema:
                $ref: App\OpenApi\ErrorResponse
              example:
                status: 400
                message: Unauthenticated.
      security:
        -
          bearerAuth: []
  '/api/hbc-things/v1/things/admin/{thing}/show':
    get:
      tags:
        - thing
        - admin
      summary: 'Shows a thing and its descendants'
      description: 'Lesser detail in decendants'
      operationId: hbc-things.things.admin.show
      parameters:
        -
          name: thing
          in: path
          description: 'uuid of the thing'
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: 'The thing'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ThingResponse'
        '400':
          description: 'When not logged in'
          content:
            application/json:
              schema:
                $ref: App\OpenApi\ErrorResponse
              example:
                status: 400
                message: Unauthenticated.
        '403':
          description: 'When not admin'
          content:
            application/json:
              schema:
                $ref: App\OpenApi\ErrorResponse
              example:
                status: 403
                message: 'Not an admin.'
      security:
        -
          bearerAuth: []
  '/api/hbc-things/v1/things/{thing}/shortcut':
    put:
      tags:
        - thing
      summary: 'Shortcuts a thing'
      description: 'If children not run they are shortcut too'
      operationId: hbc-things.things.shortcut
      parameters:
        -
          name: thing
          in: path
          description: 'uuid of the thing'
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '202':
          description: 'The thing'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ThingResponse'
        '400':
          description: 'When not logged in'
          content:
            application/json:
              schema:
                $ref: App\OpenApi\ErrorResponse
              example:
                status: 400
                message: Unauthenticated.
      security:
        -
          bearerAuth: []
  '/api/hbc-things/v1/things/{thing}/resume':
    put:
      tags:
        - thing
      summary: 'Wakes up a thing if its waiting'
      description: 'If a thing is waiting, it is dispatched again'
      operationId: hbc-things.things.resume
      parameters:
        -
          name: thing
          in: path
          description: 'uuid of the thing'
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '202':
          description: 'The thing was resumed, here is the thing info'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ThingResponse'
        '404':
          description: 'The thing was not waiting'
          content:
            application/json:
              schema:
                $ref: App\OpenApi\ErrorResponse
        '400':
          description: 'When not logged in'
          content:
            application/json:
              schema:
                $ref: App\OpenApi\ErrorResponse
              example:
                status: 400
                message: Unauthenticated.
      security:
        -
          bearerAuth: []
  '/api/hbc-things/v1/callbacks/manual/{thing_callback}/answer':
    post:
      tags:
        - callback
        - manual
      summary: 'Fill in a manual callback'
      description: 'Manual callbacks can be filled in without auth, if they are waiting'
      operationId: hbc-things.callbacks.manual_answer
      parameters:
        -
          name: thing_callback
          in: path
          description: 'uuid of the callback'
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ManualParams'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/ManualParams'
      responses:
        '202':
          description: 'The callback'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CallbackResponse'
        '400':
          description: 'When not logged in'
          content:
            application/json:
              schema:
                $ref: App\OpenApi\ErrorResponse
              example:
                status: 400
                message: Unauthenticated.
  '/api/hbc-things/v1/callbacks/manual/{thing_callback}/question':
    get:
      tags:
        - callback
        - manual
      summary: 'Show a waiting manual callback'
      description: 'Manual callbacks can be shown without auth, if they are waiting'
      operationId: hbc-things.callbacks.manual_question
      parameters:
        -
          name: thing_callback
          in: path
          description: 'uuid of the callback'
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '202':
          description: 'The callback'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CallbackResponse'
        '400':
          description: 'When not logged in'
          content:
            application/json:
              schema:
                $ref: App\OpenApi\ErrorResponse
              example:
                status: 400
                message: Unauthenticated.
  '/api/hbc-things/v1/callbacks/{thing_callback}/show':
    get:
      tags:
        - callback
      summary: 'Show a callback'
      description: ''
      operationId: hbc-things.callbacks.show
      parameters:
        -
          name: thing_callback
          in: path
          description: 'uuid of the callback'
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: 'The callback'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CallbackResponse'
        '400':
          description: 'When not logged in'
          content:
            application/json:
              schema:
                $ref: App\OpenApi\ErrorResponse
              example:
                status: 400
                message: Unauthenticated.
      security:
        -
          bearerAuth: []
  /api/hbc-things/v1/callbacks/list:
    get:
      tags:
        - callback
      summary: 'Show a list of callbacks'
      description: ''
      operationId: hbc-things.callbacks.list
      parameters:
        -
          name: 'Search params'
          in: query
          description: 'Optionally search'
          allowEmptyValue: true
          schema:
            $ref: '#/components/schemas/CallbackSearchParams'
      responses:
        '200':
          description: 'The callback list'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CallbackCollectionResponse'
        '422':
          description: 'Validation fails'
          content:
            application/json:
              schema:
                $ref: App\OpenApi\ErrorResponse
        '400':
          description: 'When not logged in'
          content:
            application/json:
              schema:
                $ref: App\OpenApi\ErrorResponse
              example:
                status: 400
                message: Unauthenticated.
      security:
        -
          bearerAuth: []
  /api/hbc-things/v1/callbacks/admin/list:
    get:
      tags:
        - callback
        - admin
      summary: 'Show a list of callbacks'
      description: ''
      operationId: hbc-things.callbacks.admin.list
      parameters:
        -
          name: 'Search params'
          in: query
          description: 'Optionally search'
          allowEmptyValue: true
          schema:
            $ref: '#/components/schemas/CallbackSearchParams'
      responses:
        '200':
          description: 'The callback list'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CallbackCollectionResponse'
        '422':
          description: 'Validation fails'
          content:
            application/json:
              schema:
                $ref: App\OpenApi\ErrorResponse
        '400':
          description: 'When not logged in'
          content:
            application/json:
              schema:
                $ref: App\OpenApi\ErrorResponse
              example:
                status: 400
                message: Unauthenticated.
      security:
        -
          bearerAuth: []
  '/api/hbc-things/v1/callbacks/admin/{thing_callback}/show':
    get:
      tags:
        - callback
        - admin
      summary: 'Show a callback'
      description: ''
      operationId: hbc-things.callbacks.admin.show
      parameters:
        -
          name: thing_callback
          in: path
          description: 'uuid of the callback'
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: 'The callback'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CallbackResponse'
        '400':
          description: 'When not logged in'
          content:
            application/json:
              schema:
                $ref: App\OpenApi\ErrorResponse
              example:
                status: 400
                message: Unauthenticated.
        '403':
          description: 'When not admin'
          content:
            application/json:
              schema:
                $ref: App\OpenApi\ErrorResponse
              example:
                status: 403
                message: 'Not an admin.'
      security:
        -
          bearerAuth: []
components:
  schemas:
    TypeOfCallback:
      description: 'postgres enum type_of_thing_callback'
      type: string
      enum:
        - DISABLED
        - HTTP_GET
        - HTTP_POST
        - HTTP_POST_FORM
        - HTTP_POST_JSON
        - HTTP_PUT
        - HTTP_PUT_FORM
        - HTTP_PUT_JSON
        - HTTP_PATCH
        - HTTP_PATCH_FORM
        - HTTP_PATCH_JSON
        - HTTP_DELETE
        - HTTP_DELETE_FORM
        - HTTP_DELETE_JSON
        - CODE
        - EVENT_CALL
    TypeOfCallbackStatus:
      description: 'postgres enum type_of_thing_callback_status'
      type: string
      enum:
        - BUILDING
        - WAITING
        - CALLBACK_SUCCESSFUL
        - CALLBACK_ERROR
    TypeOfHookMode:
      description: 'postgres enum type_of_thing_hook_mode'
      type: string
      enum:
        - NONE
        - NODE
        - NODE_FAILURE
        - NODE_SUCCESS
        - NODE_FINALLY
    TypeOfThingStatus:
      description: 'postgres enum type_of_thing_status'
      type: string
      enum:
        - THING_BUILDING
        - THING_WAITING
        - THING_PENDING
        - THING_RUNNING
        - THING_SHORT_CIRCUITED
        - THING_SUCCESS
        - THING_FAIL
        - THING_INVALID
        - THING_ERROR
    CallbackCollectionResponse:
      title: Callbacks
      description: 'A collection of hooks'
      properties:
        callbacks:
          title: 'List of Callbacks'
          description: $callbacks
          type: array
          items:
            $ref: '#/components/schemas/CallbackResponse'
        next_page:
          title: 'Next results'
          type:
            - string
            - 'null'
          format: url
        previous_page:
          title: 'Previous results'
          type:
            - string
            - 'null'
          format: url
      type: object
    CallbackResponse:
      title: Callback
      description: 'Show a callback'
      properties:
        uuid:
          title: Self
          type: string
          format: uuid
        hook_uuid:
          title: Hook
          type: string
          format: uuid
        thing_uuid:
          title: Thing
          type: string
          format: uuid
        error:
          oneOf:
            -
              $ref: '#/components/schemas/ThingErrorResponse'
            -
              type: 'null'
          title: Error
        shared_source:
          oneOf:
            -
              $ref: '#/components/schemas/CallbackResponse'
            -
              type: 'null'
          title: 'Shared callback source'
        alert_target:
          oneOf:
            -
              $ref: '#/components/schemas/CallbackResponse'
            -
              type: 'null'
          title: 'Alert target'
        alerted_by:
          oneOf:
            -
              $ref: '#/components/schemas/CallbackResponse'
            -
              type: 'null'
          title: 'Alerted by'
        code:
          title: 'Code of response'
          type:
            - integer
            - 'null'
        response:
          title: 'Response of callback'
          description: $response
          type:
            - array
            - 'null'
          items: {  }
        headers_sent:
          title: 'Headers sent'
          description: $headers_sent
          type:
            - array
            - 'null'
          items: {  }
        data_sent:
          title: 'Data sent'
          description: $data_sent
          type:
            - array
            - 'null'
          items: {  }
        status:
          $ref: '#/components/schemas/TypeOfCallbackStatus'
        hook:
          oneOf:
            -
              $ref: '#/components/schemas/HookResponse'
            -
              type: 'null'
          title: Hook
        thing:
          oneOf:
            -
              $ref: '#/components/schemas/ThingResponse'
            -
              type: 'null'
          title: Thing
        ran_at:
          title: 'Ran at'
          description: 'Iso 8601 datetime string for when this ran'
          type:
            - string
            - 'null'
          format: datetime
          example: '2025-01-25T15:00:59-06:00'
        wait_seconds:
          title: 'Wait in seconds'
          description: 'When the callback tells the thing to wait'
          type:
            - integer
            - 'null'
      type: object
    CallbackSearchParams:
      title: 'Callback search'
      description: 'Search callbacks'
      properties:
        uuid:
          title: Self
          type:
            - string
            - 'null'
          format: uuid
        hook_uuid:
          title: Hook
          type:
            - string
            - 'null'
          format: uuid
        thing_uuid:
          title: Thing
          type:
            - string
            - 'null'
          format: uuid
        error_uuid:
          title: Error
          type:
            - string
            - 'null'
          format: uuid
        alert_uuid:
          title: Alert
          type:
            - string
            - 'null'
          format: uuid
        code_range_min:
          title: 'Code range min'
          type:
            - integer
            - 'null'
        code_range_max:
          title: 'Code range min'
          type:
            - integer
            - 'null'
        is_manual:
          title: Manual
          type:
            - boolean
            - 'null'
        is_manual_notice:
          title: 'Manual notice'
          type:
            - boolean
            - 'null'
        is_blocking:
          title: Blocking
          type:
            - boolean
            - 'null'
        is_after:
          title: After
          type:
            - boolean
            - 'null'
        is_sharing:
          title: Sharing
          type:
            - boolean
            - 'null'
        status:
          oneOf:
            -
              $ref: '#/components/schemas/TypeOfCallbackStatus'
            -
              type: 'null'
          title: 'Status of callback'
        hook_callback_type:
          oneOf:
            -
              $ref: '#/components/schemas/TypeOfHookMode'
            -
              type: 'null'
          title: 'Callback type'
        thing_owner_type:
          title: 'Thing owner type filter'
          description: 'Optional type of owner used to filter. Type must exist when set'
          type:
            - string
            - 'null'
        thing_owner_id:
          title: 'Thing owner id filter'
          description: 'Optional owner used to filter.'
          type:
            - string
            - 'null'
        hook_owner_type:
          title: 'Hook owner type filter'
          description: 'Optional type of owner used to filter. Type must exist when set'
          type:
            - string
            - 'null'
        hook_owner_id:
          title: 'Hook owner id filter'
          description: 'Optional owner used to filter.'
          type:
            - string
            - 'null'
        thing_action_type:
          title: 'Thing action type filter'
          description: 'Optional type of action used to filter. Type must exist when set'
          type:
            - string
            - 'null'
        thing_action_id:
          title: 'Thing action id filter'
          description: 'Optional action used to filter.'
          type:
            - string
            - 'null'
        ran_at_min:
          title: 'Ran at range min'
          description: 'Iso 8601 datetime string'
          type:
            - string
            - 'null'
          format: datetime
          example: '2025-01-25T15:00:59-06:00'
        ran_at_max:
          title: 'Ran at range max'
          description: 'Iso 8601 datetime string'
          type:
            - string
            - 'null'
          format: datetime
          example: '2025-01-25T15:00:59-06:00'
        created_at_min:
          title: 'Created at range min'
          description: 'Iso 8601 datetime string'
          type:
            - string
            - 'null'
          format: datetime
          example: '2025-01-25T15:00:59-06:00'
        created_at_max:
          title: 'Created at range max'
          description: 'Iso 8601 datetime string'
          type:
            - string
            - 'null'
          format: datetime
          example: '2025-01-25T15:00:59-06:00'
      type: object
    ManualParams:
      title: 'Manual callback entry'
      description: 'Fill in a manual callback'
      properties:
        code:
          title: Code
          type:
            - integer
            - 'null'
        wait_in_seconds:
          title: 'Wait timeout'
          type:
            - integer
            - 'null'
        data:
          title: Data
          type:
            - array
            - 'null'
          items: {  }
      type: object
    ThingErrorCollectionResponse:
      title: 'Thing with errors'
      description: 'A collection of hooks'
      properties:
        thing:
          $ref: '#/components/schemas/ThingResponse'
        errors:
          title: 'List of Errors'
          description: $errors
          type: array
          items:
            $ref: '#/components/schemas/ThingErrorResponse'
      type: object
    ThingErrorResponse:
      title: Error
      description: 'Show a Hook'
      properties:
        code:
          title: Code
          type: integer
        ref_code:
          title: 'Reference Code'
          type:
            - integer
            - 'null'
        ref_url:
          title: 'Reference url'
          type:
            - string
            - 'null'
        message:
          title: Message
          type: string
        uuid:
          title: Self
          type: string
          format: uuid
        action_name:
          title: 'Action Name'
          type:
            - string
            - 'null'
        thing_uuid:
          title: 'Thing uuid'
          type:
            - string
            - 'null'
          format: uuid
        callback_uuid:
          title: 'Callback uuid'
          type:
            - string
            - 'null'
          format: uuid
        time:
          title: Time
          description: 'Iso 8601 datetime string for when error happened'
          type:
            - string
            - 'null'
          format: datetime
          example: '2025-01-25T15:00:59-06:00'
        related_tags:
          title: 'Related tags'
          description: $tags
          type:
            - array
            - 'null'
          items:
            type: string
      type: object
    HookCollectionResponse:
      title: Hooks
      description: 'A collection of hooks'
      properties:
        hooks:
          title: 'List of Hooks'
          description: $hooks
          type: array
          items:
            $ref: '#/components/schemas/HookResponse'
        next_page:
          title: 'Next results'
          type:
            - string
            - 'null'
          format: url
        previous_page:
          title: 'Previous results'
          type:
            - string
            - 'null'
          format: url
      type: object
    HookParams:
      title: 'Hook creation data'
      description: 'Create a new hook'
      properties:
        mode:
          $ref: '#/components/schemas/TypeOfHookMode'
          description: 'Each hook must have a mode set'
        name:
          title: Name
          description: 'Hooks can have names'
          type:
            - string
            - 'null'
        notes:
          title: Notes
          description: 'Any notes (text)'
          type:
            - string
            - 'null'
        action_type:
          title: 'Action type filter'
          description: 'Optional type of action used to filter. Type must exist when set'
          type:
            - string
            - 'null'
        action_id:
          title: 'Action id filter'
          description: 'Optional action used to filter.'
          type:
            - string
            - 'null'
        tags:
          title: 'Tags filter'
          description: 'Optional tags used to filter.'
          type:
            - array
            - 'null'
          items: {  }
        hook_on:
          title: Active
          description: 'If false, the callback is not used until this is changed.'
          type:
            - boolean
            - 'null'
        is_blocking:
          title: Blocking
          description: 'If true, then blocks.'
          type:
            - boolean
            - 'null'
        is_writing:
          title: Writing
          description: 'If true writes to thing or thing parent.'
          type:
            - boolean
            - 'null'
        is_sharing:
          title: Sharing
          description: 'If true the callback is shared among descendants.'
          type:
            - boolean
            - 'null'
        is_manual:
          title: Manual
          description: 'If true the callback is manually entered.'
          type:
            - boolean
            - 'null'
        is_after:
          title: After
          description: 'If true the callback is run after the thing is run.'
          type:
            - boolean
            - 'null'
        callback_type:
          oneOf:
            -
              $ref: '#/components/schemas/TypeOfCallback'
              description: 'What type of callback is this?'
            -
              type: 'null'
          title: 'Callback type'
          description: 'What type of callback is this?'
        ttl_shared:
          title: 'Seconds this shared is kept'
          description: 'Use only if shared'
          type:
            - integer
            - 'null'
        priority:
          title: Priority
          description: 'Order of blocking hooks run'
          type:
            - integer
            - 'null'
        data_template:
          title: 'Data template'
          description: 'The keys that make up the query|body|form|event data'
          type:
            - array
            - 'null'
          items: {  }
        header_template:
          title: 'Header template'
          description: 'The keys that make up the header for the http requests'
          type:
            - array
            - 'null'
          items: {  }
        address:
          title: Address
          description: 'the url|callable|evemt'
          type:
            - string
            - 'null'
        filter_owner_type:
          title: 'Owner type filter'
          description: 'Filter to run on things by this owner type. Type must exist when set'
          type:
            - string
            - 'null'
        filter_owner_id:
          title: 'Owner id filter'
          description: 'Filter to run on things by one owner.'
          type:
            - string
            - 'null'
      type: object
    HookResponse:
      title: Hook
      description: 'Show a Hook'
      type: object
      allOf:
        -
          $ref: '#/components/schemas/HookParams'
        -
          properties:
            uuid:
              title: Self
              type: string
              format: uuid
            owner_type:
              title: 'Owner type'
              description: 'The type of hook owner'
              type:
                - string
                - 'null'
            owner_id:
              title: 'Owner id'
              description: 'Hook owner id'
              type:
                - string
                - 'null'
            callbacks:
              oneOf:
                -
                  $ref: '#/components/schemas/CallbackCollectionResponse'
                  description: 'Callbacks generated'
                -
                  type: 'null'
              title: Callbacks
              description: 'Callbacks generated'
          type: object
    HookSearchParams:
      title: 'Thing search'
      description: 'Search things'
      properties:
        uuid:
          title: Self
          type:
            - string
            - 'null'
          format: uuid
        action_type:
          title: 'Action type filter'
          description: 'Optional type of action used to filter. Type must exist when set'
          type:
            - string
            - 'null'
        action_id:
          title: 'Action id filter'
          description: 'Optional action used to filter.'
          type:
            - string
            - 'null'
        owner_type:
          title: 'Owner type filter'
          description: 'Optional type of owner used to filter. Type must exist when set'
          type:
            - string
            - 'null'
        owner_id:
          title: 'Owner id filter'
          description: 'Optional owner used to filter.'
          type:
            - string
            - 'null'
        filter_owner_type:
          title: 'Owner type filter'
          description: 'Filter to run on things by this owner type. Type must exist when set'
          type:
            - string
            - 'null'
        filter_owner_id:
          title: 'Owner id filter'
          description: 'Filter to run on things by one owner.'
          type:
            - string
            - 'null'
        hook_on:
          title: Active
          description: 'If false, the callback is not used until this is changed.'
          type:
            - boolean
            - 'null'
        is_blocking:
          title: Blocking
          description: 'If true, then blocks.'
          type:
            - boolean
            - 'null'
        is_writing:
          title: Writing
          description: 'If true writes to thing or thing parent.'
          type:
            - boolean
            - 'null'
        is_sharing:
          title: Sharing
          description: 'If true the callback is shared among descendants.'
          type:
            - boolean
            - 'null'
        is_manual:
          title: Manual
          description: 'If true the callback is manually entered.'
          type:
            - boolean
            - 'null'
        is_after:
          title: After
          description: 'If true the callback is run after the thing is run.'
          type:
            - boolean
            - 'null'
        tags:
          title: Tags
          description: $tags
          type:
            - array
            - 'null'
          items: {  }
        callback_type:
          oneOf:
            -
              $ref: '#/components/schemas/TypeOfCallback'
              description: 'Callback type'
            -
              type: 'null'
          title: 'Callback type'
          description: 'Callback type'
        mode:
          oneOf:
            -
              $ref: '#/components/schemas/TypeOfHookMode'
              description: 'Callback type'
            -
              type: 'null'
          title: 'Hook mode'
          description: 'Callback type'
        ttl_shared_min:
          title: 'Minimum Seconds this shared is kept'
          description: 'Used only if shared'
          type:
            - integer
            - 'null'
        ttl_shared_max:
          title: 'Max Seconds this shared is kept'
          description: 'Used only if shared'
          type:
            - integer
            - 'null'
        priority_min:
          title: 'Minimum Priority'
          description: 'Order of blocking hooks run'
          type:
            - integer
            - 'null'
        priority_max:
          title: 'Max Priority'
          description: 'Order of blocking hooks run'
          type:
            - integer
            - 'null'
      type: object
    ThingCollectionResponse:
      title: Callbacks
      description: 'A collection of hooks'
      properties:
        things:
          title: 'List of Things'
          description: $things
          type: array
          items:
            $ref: '#/components/schemas/ThingResponse'
        next_page:
          title: 'Next results'
          type:
            - string
            - 'null'
          format: url
        previous_page:
          title: 'Previous results'
          type:
            - string
            - 'null'
          format: url
      type: object
    ThingResponse:
      title: Callback
      description: 'Show a Hook'
      properties:
        uuid:
          title: Self
          type: string
          format: uuid
        parent_uuid:
          title: Parent
          type:
            - string
            - 'null'
          format: uuid
        error:
          oneOf:
            -
              $ref: '#/components/schemas/ThingErrorResponse'
            -
              type: 'null'
          title: Error
        tags:
          title: Tags
          description: $tags
          type:
            - array
            - 'null'
          items:
            type: string
        action_info:
          title: 'Action data'
          description: $action_info
          type:
            - array
            - 'null'
          items: {  }
        status:
          $ref: '#/components/schemas/TypeOfThingStatus'
        action_name:
          title: 'Action name'
          type: string
        action_ref:
          title: 'Action ref'
          type: string
        owner_name:
          title: 'Owner name'
          type:
            - string
            - 'null'
        owner_ref:
          title: 'Owner ref'
          type:
            - string
            - 'null'
        async:
          title: Async
          type: boolean
        hooks:
          oneOf:
            -
              $ref: '#/components/schemas/HookCollectionResponse'
            -
              type: 'null'
          title: Hooks
        children:
          oneOf:
            -
              $ref: '#/components/schemas/ThingCollectionResponse'
            -
              type: 'null'
          title: Children
        action_html:
          title: 'Action html'
          type:
            - string
            - 'null'
        started_at:
          title: 'Started at'
          description: 'Iso 8601 datetime string for when this was started'
          type:
            - string
            - 'null'
          format: datetime
          example: '2025-01-25T15:00:59-06:00'
        ran_at:
          title: 'Ran at'
          description: 'Iso 8601 datetime string for when this ran'
          type:
            - string
            - 'null'
          format: datetime
          example: '2025-01-25T15:00:59-06:00'
        thing_wait_until_at:
          title: 'Wait until '
          description: 'Iso 8601 datetime string for when this ran'
          type:
            - string
            - 'null'
          format: datetime
          example: '2025-01-25T15:00:59-06:00'
      type: object
    ThingSearchParams:
      title: 'Thing search'
      description: 'Search things'
      properties:
        uuid:
          title: Self
          type:
            - string
            - 'null'
          format: uuid
        error_uuid:
          title: Error
          type:
            - string
            - 'null'
          format: uuid
        async:
          title: Async
          type:
            - boolean
            - 'null'
        is_root:
          title: Root
          type:
            - boolean
            - 'null'
        action_type:
          title: 'Action type filter'
          description: 'Optional type of action used to filter. Type must exist when set'
          type:
            - string
            - 'null'
        action_id:
          title: 'Action id filter'
          description: 'Optional action used to filter.'
          type:
            - string
            - 'null'
        owner_type:
          title: 'Owner type filter'
          description: 'Optional type of owner used to filter. Type must exist when set'
          type:
            - string
            - 'null'
        owner_id:
          title: 'Owner id filter'
          description: 'Optional owner used to filter.'
          type:
            - string
            - 'null'
        tags:
          title: Tags
          description: $tags
          type:
            - array
            - 'null'
          items: {  }
        status:
          oneOf:
            -
              $ref: '#/components/schemas/TypeOfThingStatus'
            -
              type: 'null'
          title: 'Status of thing'
        wait_until:
          title: 'Waiting until this time'
          description: 'Thing status is waiting and is waiting before this Iso 8601 datetime string'
          type:
            - string
            - 'null'
          format: datetime
          example: '2025-01-25T15:00:59-06:00'
        ran_at_min:
          title: 'Ran at range min'
          description: 'Iso 8601 datetime string'
          type:
            - string
            - 'null'
          format: datetime
          example: '2025-01-25T15:00:59-06:00'
        ran_at_max:
          title: 'Ran at range max'
          description: 'Iso 8601 datetime string'
          type:
            - string
            - 'null'
          format: datetime
          example: '2025-01-25T15:00:59-06:00'
        created_at_min:
          title: 'Created at range min'
          description: 'Iso 8601 datetime string'
          type:
            - string
            - 'null'
          format: datetime
          example: '2025-01-25T15:00:59-06:00'
        created_at_max:
          title: 'Created at range max'
          description: 'Iso 8601 datetime string'
          type:
            - string
            - 'null'
          format: datetime
          example: '2025-01-25T15:00:59-06:00'
        started_at_min:
          title: 'Started at range min'
          description: 'Iso 8601 datetime string'
          type:
            - string
            - 'null'
          format: datetime
          example: '2025-01-25T15:00:59-06:00'
        started_at_max:
          title: 'Started at range max'
          description: 'Iso 8601 datetime string'
          type:
            - string
            - 'null'
          format: datetime
          example: '2025-01-25T15:00:59-06:00'
      type: object
tags:
  -
    name: admin
    description: 'Requires higher privlidge to run'
  -
    name: callback
    description: 'About callbacks and their responses'
  -
    name: hook
    description: 'About thing hooks'
  -
    name: manual
    description: 'Callbacks that require answering'
  -
    name: thing
    description: 'About things'
